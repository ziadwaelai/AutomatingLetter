2025-11-26 09:27:50,149 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 09:27:50,324 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.11:5000
2025-11-26 09:27:50,324 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-26 09:27:50,329 - werkzeug - INFO -  * Restarting with stat
2025-11-26 09:27:52,789 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 09:27:52,811 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 09:27:52,816 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 09:28:26,422 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:28:28,897 - src.services.user_management_service - INFO - Found email mapping: mahmoud@fekry.design ‚Üí Sheet: 1lpiJxvbNMpfsGxCPeP3ubseCGfUwJhZo8-pbLpUyPwA, Display: 
2025-11-26 09:28:28,899 - src.services.user_management_service - INFO - Client found via EmailMappings for mahmoud@fekry.design: 
2025-11-26 09:28:28,899 - src.utils.helpers - INFO - get_client_by_email executed in 2.476s
2025-11-26 09:28:29,754 - src.services.user_management_service - ERROR - Error getting user info for mahmoud@fekry.design: 
2025-11-26 09:28:29,754 - src.utils.helpers - INFO - get_user_info executed in 0.854s
2025-11-26 09:28:29,755 - src.services.user_management_service - WARNING - Validation failed mahmoud@fekry.design: user not found in client 
2025-11-26 09:28:29,755 - src.utils.helpers - INFO - validate_user_credentials executed in 3.333s
2025-11-26 09:28:29,756 - src.api.user_routes - WARNING - User validation failed - user not found: mahmoud@fekry.design
2025-11-26 09:28:29,756 - src.utils.helpers - INFO - validate_user executed in 3.334s
2025-11-26 09:28:29,756 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:28:29,757 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:28:29] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:29:04,286 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:29:04,286 - src.utils.helpers - INFO - get_client_by_email executed in 0.000s
2025-11-26 09:29:05,125 - src.services.user_management_service - ERROR - Error getting user info for mahmoud@fekry.design: 
2025-11-26 09:29:05,125 - src.utils.helpers - INFO - get_user_info executed in 0.839s
2025-11-26 09:29:05,126 - src.services.user_management_service - WARNING - Validation failed mahmoud@fekry.design: user not found in client 
2025-11-26 09:29:05,126 - src.utils.helpers - INFO - validate_user_credentials executed in 0.840s
2025-11-26 09:29:05,126 - src.api.user_routes - WARNING - User validation failed - user not found: mahmoud@fekry.design
2025-11-26 09:29:05,126 - src.utils.helpers - INFO - validate_user executed in 0.840s
2025-11-26 09:29:05,126 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:29:05,127 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:29:05] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:29:34,863 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 09:29:34,930 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.11:5000
2025-11-26 09:29:34,931 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-26 09:29:34,933 - werkzeug - INFO -  * Restarting with stat
2025-11-26 09:29:37,087 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 09:29:37,106 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 09:29:37,109 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 09:29:38,265 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:29:40,972 - src.services.user_management_service - INFO - Found email mapping: mahmoud@fekry.design ‚Üí Sheet: 1lpiJxvbNMpfsGxCPeP3ubseCGfUwJhZo8-pbLpUyPwA, Display: 
2025-11-26 09:29:40,973 - src.services.user_management_service - INFO - Client found via EmailMappings for mahmoud@fekry.design: 
2025-11-26 09:29:40,973 - src.utils.helpers - INFO - get_client_by_email executed in 2.706s
2025-11-26 09:29:42,052 - src.services.user_management_service - ERROR - Error getting user info for mahmoud@fekry.design: 
2025-11-26 09:29:42,052 - src.utils.helpers - INFO - get_user_info executed in 1.079s
2025-11-26 09:29:42,052 - src.services.user_management_service - WARNING - Validation failed mahmoud@fekry.design: user not found in client 
2025-11-26 09:29:42,053 - src.utils.helpers - INFO - validate_user_credentials executed in 3.786s
2025-11-26 09:29:42,053 - src.api.user_routes - WARNING - User validation failed - user not found: mahmoud@fekry.design
2025-11-26 09:29:42,053 - src.utils.helpers - INFO - validate_user executed in 3.787s
2025-11-26 09:29:42,053 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:29:42,054 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:29:42] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:31:22,494 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:31:24,256 - src.services.user_management_service - INFO - Found email mapping: lamya.ithra@gmail.com ‚Üí Sheet: 1TZitoB65fuD-K8vEI-M7Z2tCOWs2D9clMhGvyW__gR4, Display: lamya
2025-11-26 09:31:24,257 - src.services.user_management_service - INFO - Client found via EmailMappings for lamya.ithra@gmail.com: lamya
2025-11-26 09:31:24,257 - src.utils.helpers - INFO - get_client_by_email executed in 1.764s
2025-11-26 09:31:26,397 - src.services.user_management_service - INFO - User found: Lamya.ithra@gmail.com in client sheet 1TZitoB65fuD-K8vEI-M7Z2tCOWs2D9clMhGvyW__gR4
2025-11-26 09:31:26,397 - src.utils.helpers - INFO - get_user_info executed in 2.139s
2025-11-26 09:31:26,462 - src.services.user_management_service - INFO - User credentials validated successfully: Lamya.ithra@gmail.com for client lamya
2025-11-26 09:31:26,462 - src.utils.helpers - INFO - validate_user_credentials executed in 3.969s
2025-11-26 09:31:26,462 - src.api.user_routes - INFO - User validated successfully: Lamya.ithra@gmail.com
2025-11-26 09:31:26,463 - src.utils.helpers - INFO - validate_user executed in 3.970s
2025-11-26 09:31:26,463 - __main__ - INFO - Response: 200 - user.validate_user
2025-11-26 09:31:26,464 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:31:26] "POST /api/v1/user/validate HTTP/1.1" 200 -
2025-11-26 09:32:45,264 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:32:47,589 - src.services.user_management_service - INFO - Found email mapping: mahmoud@fekry.design ‚Üí Sheet: 1lpiJxvbNMpfsGxCPeP3ubseCGfUwJhZo8-pbLpUyPwA, Display: 
2025-11-26 09:32:47,590 - src.services.user_management_service - INFO - Client found via EmailMappings for mahmoud@fekry.design: 
2025-11-26 09:32:47,590 - src.utils.helpers - INFO - get_client_by_email executed in 2.326s
2025-11-26 09:32:48,405 - src.services.user_management_service - ERROR - Error getting user info for mahmoud@fekry.design: 
2025-11-26 09:32:48,406 - src.utils.helpers - INFO - get_user_info executed in 0.816s
2025-11-26 09:32:48,406 - src.services.user_management_service - WARNING - Validation failed mahmoud@fekry.design: user not found in client 
2025-11-26 09:32:48,406 - src.utils.helpers - INFO - validate_user_credentials executed in 3.142s
2025-11-26 09:32:48,406 - src.api.user_routes - WARNING - User validation failed - user not found: mahmoud@fekry.design
2025-11-26 09:32:48,406 - src.utils.helpers - INFO - validate_user executed in 3.142s
2025-11-26 09:32:48,407 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:32:48,407 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:32:48] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:33:36,134 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:33:36,135 - src.services.user_management_service - INFO - Found email mapping: aljabre.haya@gmail.com ‚Üí Sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, Display: aliabre
2025-11-26 09:33:36,135 - src.services.user_management_service - INFO - Client found via EmailMappings for aljabre.haya@gmail.com: aliabre
2025-11-26 09:33:36,136 - src.utils.helpers - INFO - get_client_by_email executed in 0.001s
2025-11-26 09:33:37,022 - src.services.user_management_service - ERROR - Error getting user info for Aljabre.haya@gmail.com: 
2025-11-26 09:33:37,024 - src.utils.helpers - INFO - get_user_info executed in 0.887s
2025-11-26 09:33:37,024 - src.services.user_management_service - WARNING - Validation failed Aljabre.haya@gmail.com: user not found in client aliabre
2025-11-26 09:33:37,024 - src.utils.helpers - INFO - validate_user_credentials executed in 0.889s
2025-11-26 09:33:37,024 - src.api.user_routes - WARNING - User validation failed - user not found: Aljabre.haya@gmail.com
2025-11-26 09:33:37,025 - src.utils.helpers - INFO - validate_user executed in 0.891s
2025-11-26 09:33:37,025 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:33:37,025 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:33:37] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:33:43,599 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:33:43,600 - src.utils.helpers - INFO - get_client_by_email executed in 0.000s
2025-11-26 09:33:44,360 - src.services.user_management_service - ERROR - Error getting user info for Aljabre.haya@gmail.com: 
2025-11-26 09:33:44,362 - src.utils.helpers - INFO - get_user_info executed in 0.761s
2025-11-26 09:33:44,362 - src.services.user_management_service - WARNING - Validation failed Aljabre.haya@gmail.com: user not found in client aliabre
2025-11-26 09:33:44,362 - src.utils.helpers - INFO - validate_user_credentials executed in 0.761s
2025-11-26 09:33:44,362 - src.api.user_routes - WARNING - User validation failed - user not found: Aljabre.haya@gmail.com
2025-11-26 09:33:44,362 - src.utils.helpers - INFO - validate_user executed in 0.762s
2025-11-26 09:33:44,362 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:33:44,363 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:33:44] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:33:58,983 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:33:59,825 - src.services.user_management_service - INFO - Found email mapping: ziad2@gmail.com ‚Üí Sheet: 1s150RSZoOTPjlxqqI8AItImI4jVYOIcPFsuBiMXe1dk, Display: mmk
2025-11-26 09:33:59,826 - src.services.user_management_service - INFO - Client found via EmailMappings for ziad2@gmail.com: mmk
2025-11-26 09:33:59,826 - src.utils.helpers - INFO - get_client_by_email executed in 0.844s
2025-11-26 09:34:01,578 - src.services.user_management_service - INFO - User found: ziad2@gmail.com in client sheet 1s150RSZoOTPjlxqqI8AItImI4jVYOIcPFsuBiMXe1dk
2025-11-26 09:34:01,578 - src.utils.helpers - INFO - get_user_info executed in 1.751s
2025-11-26 09:34:01,649 - src.services.user_management_service - WARNING - Validation failed ziad2@gmail.com: invalid password
2025-11-26 09:34:01,649 - src.utils.helpers - INFO - validate_user_credentials executed in 2.666s
2025-11-26 09:34:01,649 - src.api.user_routes - WARNING - User validation failed - invalid password: ziad2@gmail.com
2025-11-26 09:34:01,650 - src.utils.helpers - INFO - validate_user executed in 2.667s
2025-11-26 09:34:01,650 - __main__ - INFO - Response: 401 - user.validate_user
2025-11-26 09:34:01,650 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:34:01] "[31m[1mPOST /api/v1/user/validate HTTP/1.1[0m" 401 -
2025-11-26 09:34:20,340 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:34:20,341 - src.utils.helpers - INFO - get_client_by_email executed in 0.000s
2025-11-26 09:34:21,125 - src.services.user_management_service - ERROR - Error getting user info for Aljabre.haya@gmail.com: 
2025-11-26 09:34:21,126 - src.utils.helpers - INFO - get_user_info executed in 0.785s
2025-11-26 09:34:21,126 - src.services.user_management_service - WARNING - Validation failed Aljabre.haya@gmail.com: user not found in client aliabre
2025-11-26 09:34:21,126 - src.utils.helpers - INFO - validate_user_credentials executed in 0.785s
2025-11-26 09:34:21,127 - src.api.user_routes - WARNING - User validation failed - user not found: Aljabre.haya@gmail.com
2025-11-26 09:34:21,127 - src.utils.helpers - INFO - validate_user executed in 0.786s
2025-11-26 09:34:21,127 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:34:21,127 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:34:21] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:35:11,512 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 09:35:11,575 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.11:5000
2025-11-26 09:35:11,576 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-26 09:35:11,578 - werkzeug - INFO -  * Restarting with stat
2025-11-26 09:35:13,483 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 09:35:13,504 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 09:35:13,508 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 09:35:15,600 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:35:17,457 - src.services.user_management_service - INFO - Found email mapping: aljabre.haya@gmail.com ‚Üí Sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, Display: aliabre
2025-11-26 09:35:17,457 - src.services.user_management_service - INFO - Client found via EmailMappings for aljabre.haya@gmail.com: aliabre
2025-11-26 09:35:17,457 - src.utils.helpers - INFO - get_client_by_email executed in 1.855s
2025-11-26 09:35:17,783 - src.services.user_management_service - ERROR - Error getting user info for Aljabre.haya@gmail.com: 
2025-11-26 09:35:17,784 - src.utils.helpers - INFO - get_user_info executed in 0.326s
2025-11-26 09:35:17,784 - src.services.user_management_service - WARNING - Validation failed Aljabre.haya@gmail.com: user not found in client aliabre
2025-11-26 09:35:17,784 - src.utils.helpers - INFO - validate_user_credentials executed in 2.183s
2025-11-26 09:35:17,785 - src.api.user_routes - WARNING - User validation failed - user not found: Aljabre.haya@gmail.com
2025-11-26 09:35:17,785 - src.utils.helpers - INFO - validate_user executed in 2.184s
2025-11-26 09:35:17,786 - __main__ - INFO - Response: 404 - user.validate_user
2025-11-26 09:35:17,787 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:35:17] "[33mPOST /api/v1/user/validate HTTP/1.1[0m" 404 -
2025-11-26 09:36:00,297 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:36:00,297 - src.services.user_management_service - INFO - Found email mapping: lamya.ithra@gmail.com ‚Üí Sheet: 1TZitoB65fuD-K8vEI-M7Z2tCOWs2D9clMhGvyW__gR4, Display: lamya
2025-11-26 09:36:00,298 - src.services.user_management_service - INFO - Client found via EmailMappings for lamya.ithra@gmail.com: lamya
2025-11-26 09:36:00,300 - src.utils.helpers - INFO - get_client_by_email executed in 0.003s
2025-11-26 09:36:01,650 - src.services.user_management_service - INFO - User found: Lamya.ithra@gmail.com in client sheet 1TZitoB65fuD-K8vEI-M7Z2tCOWs2D9clMhGvyW__gR4
2025-11-26 09:36:01,651 - src.utils.helpers - INFO - get_user_info executed in 1.350s
2025-11-26 09:36:01,718 - src.services.user_management_service - INFO - User credentials validated successfully: Lamya.ithra@gmail.com for client lamya
2025-11-26 09:36:01,718 - src.utils.helpers - INFO - validate_user_credentials executed in 1.421s
2025-11-26 09:36:01,718 - src.api.user_routes - INFO - User validated successfully: Lamya.ithra@gmail.com
2025-11-26 09:36:01,719 - src.utils.helpers - INFO - validate_user executed in 1.422s
2025-11-26 09:36:01,719 - __main__ - INFO - Response: 200 - user.validate_user
2025-11-26 09:36:01,720 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:36:01] "POST /api/v1/user/validate HTTP/1.1" 200 -
2025-11-26 09:37:21,198 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/user/validate - 127.0.0.1
2025-11-26 09:37:22,295 - src.services.user_management_service - INFO - Found email mapping: aljabre.haya@gmail.com ‚Üí Sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, Display: aliabre
2025-11-26 09:37:22,295 - src.services.user_management_service - INFO - Client found via EmailMappings for aljabre.haya@gmail.com: aliabre
2025-11-26 09:37:22,296 - src.utils.helpers - INFO - get_client_by_email executed in 1.098s
2025-11-26 09:37:24,082 - src.services.user_management_service - INFO - User found: Aljabre.haya@gmail.com in client sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI
2025-11-26 09:37:24,083 - src.utils.helpers - INFO - get_user_info executed in 1.787s
2025-11-26 09:37:24,157 - src.services.user_management_service - INFO - User credentials validated successfully: Aljabre.haya@gmail.com for client aliabre
2025-11-26 09:37:24,157 - src.utils.helpers - INFO - validate_user_credentials executed in 2.959s
2025-11-26 09:37:24,157 - src.api.user_routes - INFO - User validated successfully: Aljabre.haya@gmail.com
2025-11-26 09:37:24,158 - src.utils.helpers - INFO - validate_user executed in 2.960s
2025-11-26 09:37:24,158 - __main__ - INFO - Response: 200 - user.validate_user
2025-11-26 09:37:24,158 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 09:37:24] "POST /api/v1/user/validate HTTP/1.1" 200 -
2025-11-26 10:09:11,810 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\services\\doc_services.py', reloading
2025-11-26 10:09:12,211 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:09:17,122 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:09:17,146 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:09:17,151 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:09:49,018 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\api\\archive_routes.py', reloading
2025-11-26 10:09:49,261 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:09:51,749 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:09:51,776 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:09:51,781 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:09:53,090 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\services\\doc_services.py', reloading
2025-11-26 10:09:53,314 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:09:55,701 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:09:55,738 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:09:55,742 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:09:58,115 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\services\\doc_services.py', reloading
2025-11-26 10:09:58,359 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:10:00,444 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:10:00,468 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:10:00,471 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:10:16,073 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\services\\doc_services.py', reloading
2025-11-26 10:10:16,413 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:11:12,171 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:11:12,213 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.11:5000
2025-11-26 10:11:12,213 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-26 10:11:12,215 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:11:14,284 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:11:14,308 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:11:14,311 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:11:57,321 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/archive/letter/docx - 127.0.0.1
2025-11-26 10:11:57,321 - src.api.archive_routes - INFO - DOCX Archive request from user: Aljabre.haya@gmail.com, client: EMAIL-MAP-aljabre.haya, sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, drive: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0
2025-11-26 10:11:57,322 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Starting background DOCX archiving for letter ID: LET-202510sdfsd5523
2025-11-26 10:11:57,322 - src.api.archive_routes - INFO - Letter DOCX archiving initiated for ID: LET-202510sdfsd5523 (sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI)
2025-11-26 10:11:57,323 - src.utils.helpers - INFO - archive_letter_docx executed in 0.002s
2025-11-26 10:11:57,324 - src.services.drive_logger - INFO - Drive Logger service initialized
2025-11-26 10:11:57,324 - __main__ - INFO - Response: 200 - archive.archive_letter_docx
2025-11-26 10:11:57,324 - src.api.archive_routes - ERROR - [DOCX BACKGROUND] ‚ùå CRITICAL ERROR in background DOCX archiving for letter ID LET-202510sdfsd5523: name 'template' is not defined
Traceback (most recent call last):
  File "D:\shobbak\AutomatingLetter\src\api\archive_routes.py", line 399, in process_letter_docx_archive_in_background
    logger.info(f"[DOCX BACKGROUND] Creating DOCX document for letter ID: {letter_id} with template: {template}")
                                                                                                      ^^^^^^^^
NameError: name 'template' is not defined
2025-11-26 10:11:57,325 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 10:11:57] "POST /api/v1/archive/letter/docx HTTP/1.1" 200 -
2025-11-26 10:12:52,193 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\api\\archive_routes.py', reloading
2025-11-26 10:12:52,527 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:12:54,643 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:12:54,660 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:12:54,667 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:13:05,691 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\api\\archive_routes.py', reloading
2025-11-26 10:13:05,927 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:13:07,924 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:13:07,943 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:13:07,946 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:13:19,128 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/archive/letter/docx - 127.0.0.1
2025-11-26 10:13:19,129 - src.api.archive_routes - INFO - DOCX Archive request from user: Aljabre.haya@gmail.com, client: EMAIL-MAP-aljabre.haya, sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, drive: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0
2025-11-26 10:13:19,130 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Starting background DOCX archiving for letter ID: LET-202510sdfsd5523
2025-11-26 10:13:19,130 - src.api.archive_routes - INFO - Letter DOCX archiving initiated for ID: LET-202510sdfsd5523 (sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI)
2025-11-26 10:13:19,131 - src.services.drive_logger - INFO - Drive Logger service initialized
2025-11-26 10:13:19,132 - src.utils.helpers - INFO - archive_letter_docx executed in 0.003s
2025-11-26 10:13:19,133 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Creating DOCX document for letter ID: LET-202510sdfsd5523 with template: default
2025-11-26 10:13:19,133 - __main__ - INFO - Response: 200 - archive.archive_letter_docx
2025-11-26 10:13:19,134 - src.services.doc_services - INFO - Using template 'default': D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:13:19,134 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 10:13:19] "POST /api/v1/archive/letter/docx HTTP/1.1" 200 -
2025-11-26 10:13:19,627 - src.services.doc_services - INFO - Starting raw letter content parsing with GPT-4o
2025-11-26 10:13:27,083 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:13:27,103 - src.services.doc_services - INFO - Letter content parsed successfully
2025-11-26 10:13:27,104 - src.services.doc_services - INFO - Document letter ID set to: LET-202510sdfsd5523
2025-11-26 10:13:27,129 - src.services.doc_services - INFO - Template loaded successfully from: D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:13:32,748 - src.services.doc_services - INFO - Document created successfully from JSON (Letter ID: LET-202510sdfsd5523)
2025-11-26 10:13:32,755 - src.services.doc_services - INFO - Document saved successfully to: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:13:32,755 - src.api.archive_routes - INFO - [DOCX BACKGROUND] DOCX generated successfully: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:13:32,755 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Uploading DOCX to Drive and logging for letter ID: LET-202510sdfsd5523
2025-11-26 10:13:32,787 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-11-26 10:13:33,710 - src.services.drive_logger - ERROR - Error uploading file to Drive: <HttpError 404 when requesting None returned "File not found: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0.". Details: "[{'message': 'File not found: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0.', 'domain': 'global', 'reason': 'notFound', 'location': 'fileId', 'locationType': 'parameter'}]">
2025-11-26 10:13:33,711 - src.services.drive_logger - ERROR - Failed to upload DOCX letter LET-202510sdfsd5523 to Drive: <HttpError 404 when requesting None returned "File not found: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0.". Details: "[{'message': 'File not found: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0.', 'domain': 'global', 'reason': 'notFound', 'location': 'fileId', 'locationType': 'parameter'}]">
2025-11-26 10:13:33,712 - src.api.archive_routes - ERROR - [DOCX BACKGROUND] ‚ùå Background DOCX archiving failed for letter ID: LET-202510sdfsd5523: Drive upload failed: <HttpError 404 when requesting None returned "File not found: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0.". Details: "[{'message': 'File not found: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0.', 'domain': 'global', 'reason': 'notFound', 'location': 'fileId', 'locationType': 'parameter'}]">
2025-11-26 10:15:59,024 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/archive/letter/docx - 127.0.0.1
2025-11-26 10:15:59,025 - src.api.archive_routes - INFO - DOCX Archive request from user: Aljabre.haya@gmail.com, client: EMAIL-MAP-aljabre.haya, sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, drive: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0
2025-11-26 10:15:59,025 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Starting background DOCX archiving for letter ID: LET-202510sdfsd5523
2025-11-26 10:15:59,025 - src.api.archive_routes - INFO - Letter DOCX archiving initiated for ID: LET-202510sdfsd5523 (sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI)
2025-11-26 10:15:59,026 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Creating DOCX document for letter ID: LET-202510sdfsd5523 with template: default
2025-11-26 10:15:59,026 - src.utils.helpers - INFO - archive_letter_docx executed in 0.001s
2025-11-26 10:15:59,026 - __main__ - INFO - Response: 200 - archive.archive_letter_docx
2025-11-26 10:15:59,026 - src.services.doc_services - INFO - Using template 'default': D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:15:59,027 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 10:15:59] "POST /api/v1/archive/letter/docx HTTP/1.1" 200 -
2025-11-26 10:15:59,028 - src.services.doc_services - INFO - Starting raw letter content parsing with GPT-4o
2025-11-26 10:16:03,000 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:16:03,021 - src.services.doc_services - INFO - Letter content parsed successfully
2025-11-26 10:16:03,021 - src.services.doc_services - INFO - Document letter ID set to: LET-202510sdfsd5523
2025-11-26 10:16:03,032 - src.services.doc_services - INFO - Template loaded successfully from: D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:16:03,038 - src.services.doc_services - INFO - Document created successfully from JSON (Letter ID: LET-202510sdfsd5523)
2025-11-26 10:16:03,048 - src.services.doc_services - INFO - Document saved successfully to: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:16:03,048 - src.api.archive_routes - INFO - [DOCX BACKGROUND] DOCX generated successfully: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:16:03,048 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Uploading DOCX to Drive and logging for letter ID: LET-202510sdfsd5523
2025-11-26 10:16:03,052 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-11-26 10:16:06,638 - src.services.drive_logger - INFO - File uploaded to Drive: Invitation Letter_LET-202510sdfsd5523.docx (ID: 1I9T6hXlhc63cyOaQXzHjIUs_0DNrfhox)
2025-11-26 10:16:10,310 - src.services.google_services - INFO - Successfully logged 1 entries to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, worksheet 'Submissions'
2025-11-26 10:16:10,310 - src.utils.helpers - INFO - log_entries_by_id executed in 3.671s
2025-11-26 10:16:10,311 - src.services.drive_logger - INFO - Successfully archived DOCX letter LET-202510sdfsd5523 to Drive and logged to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI
2025-11-26 10:16:10,311 - src.api.archive_routes - INFO - [DOCX BACKGROUND] ‚úÖ Background DOCX archiving completed successfully for letter ID: LET-202510sdfsd5523
2025-11-26 10:16:10,311 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Drive URL: https://docs.google.com/document/d/1I9T6hXlhc63cyOaQXzHjIUs_0DNrfhox/edit?usp=drivesdk&ouid=110299286448075581316&rtpof=true&sd=true
2025-11-26 10:18:36,002 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\services\\drive_logger.py', reloading
2025-11-26 10:18:36,516 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:18:39,018 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:18:39,043 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:18:39,047 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:18:55,994 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/archive/letter/docx - 127.0.0.1
2025-11-26 10:18:55,995 - src.api.archive_routes - INFO - DOCX Archive request from user: Aljabre.haya@gmail.com, client: EMAIL-MAP-aljabre.haya, sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, drive: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0
2025-11-26 10:18:55,996 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Starting background DOCX archiving for letter ID: LET-202510sdfsd5523
2025-11-26 10:18:55,996 - src.api.archive_routes - INFO - Letter DOCX archiving initiated for ID: LET-202510sdfsd5523 (sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI)
2025-11-26 10:18:55,996 - src.utils.helpers - INFO - archive_letter_docx executed in 0.001s
2025-11-26 10:18:55,997 - __main__ - INFO - Response: 200 - archive.archive_letter_docx
2025-11-26 10:18:55,997 - src.services.drive_logger - INFO - Drive Logger service initialized
2025-11-26 10:18:55,997 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 10:18:55] "POST /api/v1/archive/letter/docx HTTP/1.1" 200 -
2025-11-26 10:18:55,997 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Creating DOCX document for letter ID: LET-202510sdfsd5523 with template: default
2025-11-26 10:18:55,998 - src.services.doc_services - INFO - Using template 'default': D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:18:56,346 - src.services.doc_services - INFO - Starting raw letter content parsing with GPT-4o
2025-11-26 10:19:00,460 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:19:00,488 - src.services.doc_services - INFO - Letter content parsed successfully
2025-11-26 10:19:00,489 - src.services.doc_services - INFO - Document letter ID set to: LET-202510sdfsd5523
2025-11-26 10:19:00,496 - src.services.doc_services - INFO - Template loaded successfully from: D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:19:00,609 - src.services.doc_services - INFO - Document created successfully from JSON (Letter ID: LET-202510sdfsd5523)
2025-11-26 10:19:00,616 - src.services.doc_services - INFO - Document saved successfully to: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:19:00,617 - src.api.archive_routes - INFO - [DOCX BACKGROUND] DOCX generated successfully: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:19:00,617 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Uploading DOCX to Drive and logging for letter ID: LET-202510sdfsd5523
2025-11-26 10:19:00,623 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-11-26 10:19:06,141 - src.services.drive_logger - INFO - File made public: Invitation Letter_LET-202510sdfsd5523.docx (ID: 1R7mP1oT2pCk96-izbGtzK5her73S_2XY)
2025-11-26 10:19:06,642 - src.services.drive_logger - INFO - File uploaded to Drive: Invitation Letter_LET-202510sdfsd5523.docx (ID: 1R7mP1oT2pCk96-izbGtzK5her73S_2XY)
2025-11-26 10:19:09,513 - src.services.google_services - INFO - Successfully logged 1 entries to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, worksheet 'Submissions'
2025-11-26 10:19:09,514 - src.utils.helpers - INFO - log_entries_by_id executed in 2.872s
2025-11-26 10:19:09,515 - src.services.drive_logger - INFO - Successfully archived DOCX letter LET-202510sdfsd5523 to Drive and logged to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI
2025-11-26 10:19:09,516 - src.api.archive_routes - INFO - [DOCX BACKGROUND] ‚úÖ Background DOCX archiving completed successfully for letter ID: LET-202510sdfsd5523
2025-11-26 10:19:09,517 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Drive URL: https://docs.google.com/document/d/1R7mP1oT2pCk96-izbGtzK5her73S_2XY/edit?usp=drivesdk&ouid=110299286448075581316&rtpof=true&sd=true
2025-11-26 10:20:08,063 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\services\\drive_logger.py', reloading
2025-11-26 10:20:08,547 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:20:11,026 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:20:11,050 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:20:11,053 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:20:12,817 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/archive/letter/docx - 127.0.0.1
2025-11-26 10:20:12,817 - src.api.archive_routes - INFO - DOCX Archive request from user: Aljabre.haya@gmail.com, client: EMAIL-MAP-aljabre.haya, sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, drive: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0
2025-11-26 10:20:12,818 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Starting background DOCX archiving for letter ID: LET-202510sdfsd5523
2025-11-26 10:20:12,818 - src.api.archive_routes - INFO - Letter DOCX archiving initiated for ID: LET-202510sdfsd5523 (sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI)
2025-11-26 10:20:12,819 - src.services.drive_logger - INFO - Drive Logger service initialized
2025-11-26 10:20:12,819 - src.utils.helpers - INFO - archive_letter_docx executed in 0.002s
2025-11-26 10:20:12,820 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Creating DOCX document for letter ID: LET-202510sdfsd5523 with template: default
2025-11-26 10:20:12,820 - __main__ - INFO - Response: 200 - archive.archive_letter_docx
2025-11-26 10:20:12,820 - src.services.doc_services - INFO - Using template 'default': D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:20:12,822 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 10:20:12] "POST /api/v1/archive/letter/docx HTTP/1.1" 200 -
2025-11-26 10:20:13,098 - src.services.doc_services - INFO - Starting raw letter content parsing with GPT-4o
2025-11-26 10:20:17,992 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:20:18,007 - src.services.doc_services - INFO - Letter content parsed successfully
2025-11-26 10:20:18,008 - src.services.doc_services - INFO - Document letter ID set to: LET-202510sdfsd5523
2025-11-26 10:20:18,013 - src.services.doc_services - INFO - Template loaded successfully from: D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:20:18,093 - src.services.doc_services - INFO - Document created successfully from JSON (Letter ID: LET-202510sdfsd5523)
2025-11-26 10:20:18,102 - src.services.doc_services - INFO - Document saved successfully to: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:20:18,102 - src.api.archive_routes - INFO - [DOCX BACKGROUND] DOCX generated successfully: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:20:18,102 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Uploading DOCX to Drive and logging for letter ID: LET-202510sdfsd5523
2025-11-26 10:20:18,106 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-11-26 10:20:21,433 - src.services.drive_logger - WARNING - Could not make file public (file still uploaded): <HttpError 400 when requesting https://www.googleapis.com/drive/v3/files/1ibX5mO0PTfPvOty9L3fDK6DuCBWoBhuX/permissions?alt=json returned "The specified permission role is invalid. Valid values are 'reader', 'commenter', 'writer', 'fileOrganizer', 'organizer', and 'owner'.". Details: "[{'message': "The specified permission role is invalid. Valid values are 'reader', 'commenter', 'writer', 'fileOrganizer', 'organizer', and 'owner'.", 'domain': 'global', 'reason': 'invalid', 'location': 'permission.role', 'locationType': 'other'}]">
2025-11-26 10:20:21,935 - src.services.drive_logger - INFO - File uploaded to Drive: Invitation Letter_LET-202510sdfsd5523.docx (ID: 1ibX5mO0PTfPvOty9L3fDK6DuCBWoBhuX)
2025-11-26 10:20:25,745 - src.services.google_services - INFO - Successfully logged 1 entries to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, worksheet 'Submissions'
2025-11-26 10:20:25,746 - src.utils.helpers - INFO - log_entries_by_id executed in 3.810s
2025-11-26 10:20:25,746 - src.services.drive_logger - INFO - Successfully archived DOCX letter LET-202510sdfsd5523 to Drive and logged to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI
2025-11-26 10:20:25,747 - src.api.archive_routes - INFO - [DOCX BACKGROUND] ‚úÖ Background DOCX archiving completed successfully for letter ID: LET-202510sdfsd5523
2025-11-26 10:20:25,747 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Drive URL: https://docs.google.com/document/d/1ibX5mO0PTfPvOty9L3fDK6DuCBWoBhuX/edit?usp=drivesdk&ouid=110299286448075581316&rtpof=true&sd=true
2025-11-26 10:20:38,995 - werkzeug - INFO -  * Detected change in 'D:\\shobbak\\AutomatingLetter\\src\\services\\drive_logger.py', reloading
2025-11-26 10:20:39,366 - werkzeug - INFO -  * Restarting with stat
2025-11-26 10:20:41,314 - root - INFO - Logging initialized: logs/app.log (time-based rotation, 30 day retention)
2025-11-26 10:20:41,333 - werkzeug - WARNING -  * Debugger is active!
2025-11-26 10:20:41,337 - werkzeug - INFO -  * Debugger PIN: 129-536-069
2025-11-26 10:20:52,197 - __main__ - INFO - POST http://127.0.0.1:5000/api/v1/archive/letter/docx - 127.0.0.1
2025-11-26 10:20:52,197 - src.api.archive_routes - INFO - DOCX Archive request from user: Aljabre.haya@gmail.com, client: EMAIL-MAP-aljabre.haya, sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, drive: 1foNQ0MscYFyNV8veEDGPP6s-TRU2SAP0
2025-11-26 10:20:52,198 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Starting background DOCX archiving for letter ID: LET-202510sdfsd5523
2025-11-26 10:20:52,198 - src.api.archive_routes - INFO - Letter DOCX archiving initiated for ID: LET-202510sdfsd5523 (sheet: 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI)
2025-11-26 10:20:52,202 - src.utils.helpers - INFO - archive_letter_docx executed in 0.006s
2025-11-26 10:20:52,203 - __main__ - INFO - Response: 200 - archive.archive_letter_docx
2025-11-26 10:20:52,204 - werkzeug - INFO - 127.0.0.1 - - [26/Nov/2025 10:20:52] "POST /api/v1/archive/letter/docx HTTP/1.1" 200 -
2025-11-26 10:20:52,237 - src.services.drive_logger - INFO - Drive Logger service initialized
2025-11-26 10:20:52,238 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Creating DOCX document for letter ID: LET-202510sdfsd5523 with template: default
2025-11-26 10:20:52,238 - src.services.doc_services - INFO - Using template 'default': D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:20:52,635 - src.services.doc_services - INFO - Starting raw letter content parsing with GPT-4o
2025-11-26 10:20:56,204 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-11-26 10:20:56,222 - src.services.doc_services - INFO - Letter content parsed successfully
2025-11-26 10:20:56,222 - src.services.doc_services - INFO - Document letter ID set to: LET-202510sdfsd5523
2025-11-26 10:20:56,228 - src.services.doc_services - INFO - Template loaded successfully from: D:\shobbak\AutomatingLetter\LetterToPdf\templates\default.docx
2025-11-26 10:20:56,397 - src.services.doc_services - INFO - Document created successfully from JSON (Letter ID: LET-202510sdfsd5523)
2025-11-26 10:20:56,407 - src.services.doc_services - INFO - Document saved successfully to: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:20:56,407 - src.api.archive_routes - INFO - [DOCX BACKGROUND] DOCX generated successfully: C:\Users\ZIAD~1.ABD\AppData\Local\Temp\Invitation Letter_LET-202510sdfsd5523.docx
2025-11-26 10:20:56,407 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Uploading DOCX to Drive and logging for letter ID: LET-202510sdfsd5523
2025-11-26 10:20:56,412 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-11-26 10:21:03,073 - src.services.drive_logger - INFO - File made public: Invitation Letter_LET-202510sdfsd5523.docx (ID: 1VBKjwID_dpH9rbPSC6YaiYe3hhyj_K8O)
2025-11-26 10:21:03,574 - src.services.drive_logger - INFO - File uploaded to Drive: Invitation Letter_LET-202510sdfsd5523.docx (ID: 1VBKjwID_dpH9rbPSC6YaiYe3hhyj_K8O)
2025-11-26 10:21:06,031 - src.services.google_services - INFO - Successfully logged 1 entries to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI, worksheet 'Submissions'
2025-11-26 10:21:06,032 - src.utils.helpers - INFO - log_entries_by_id executed in 2.457s
2025-11-26 10:21:06,032 - src.services.drive_logger - INFO - Successfully archived DOCX letter LET-202510sdfsd5523 to Drive and logged to sheet 1OQhlAoiWU8YRKAMZqpuDFnAGnUbK6QZT1I47YuO7IyI
2025-11-26 10:21:06,033 - src.api.archive_routes - INFO - [DOCX BACKGROUND] ‚úÖ Background DOCX archiving completed successfully for letter ID: LET-202510sdfsd5523
2025-11-26 10:21:06,033 - src.api.archive_routes - INFO - [DOCX BACKGROUND] Drive URL: https://docs.google.com/document/d/1VBKjwID_dpH9rbPSC6YaiYe3hhyj_K8O/edit?usp=drivesdk&ouid=110299286448075581316&rtpof=true&sd=true
